•
TC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\SignalrServer.cs
	namespace 	
Group5_MusicPlayer
 
{ 
public 

class 
SignalrServer 
:  
Hub! $
{ 
} 
} ˙
NC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 

AddSignalR 
( 
) 
; 
builder 
. 
Services 
. #
AddControllersWithViews (
(( )
)) *
;* +
builder 
. 
Services 
. 

AddSession 
( 
options #
=>$ &
{ 
options 
. 
IdleTimeout 
= 
TimeSpan "
." #
FromSeconds# .
(. /
$num/ 1
*2 3
$num4 6
*7 8
$num9 ;
); <
;< =
options 
. 
Cookie 
. 
HttpOnly 
= 
true "
;" #
} 
) 
; 
builder 
. 
Services 
. "
AddHttpContextAccessor '
(' (
)( )
;) *
builder 
. 
Services 
. 
AddDbContext 
<  
MusicPlayerDbContext 2
>2 3
(3 4
options4 ;
=>< >
options 
. 
UseSqlServer 
( 
builder  
.  !
Configuration! .
. 
GetConnectionString 
( 
$str '
)' (
)( )
)) *
;* +
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
app 
. 

UseSession 
( 
) 
; 
if%% 
(%% 
!%% 
app%% 
.%% 	
Environment%%	 
.%% 
IsDevelopment%% "
(%%" #
)%%# $
)%%$ %
{&& 
app'' 
.'' 
UseExceptionHandler'' 
('' 
$str'' )
)'') *
;''* +
app)) 
.)) 
UseHsts)) 
()) 
))) 
;)) 
}** 
app,, 
.,, 
UseHttpsRedirection,, 
(,, 
),, 
;,, 
app-- 
.-- 
UseStaticFiles-- 
(-- 
)-- 
;-- 
app.. 
... 

UseRouting.. 
(.. 
).. 
;.. 
app// 
.// 
UseAuthorization// 
(// 
)// 
;// 
app22 
.22 
UseEndpoints22 
(22 
	endpoints22 
=>22 
{33 
	endpoints44 
.44 
MapHub44 
<44 
SignalrServer44 "
>44" #
(44# $
$str44$ 4
)444 5
;445 6
}55 
)55 
;55 
app77 
.77 
MapControllerRoute77 
(77 
name88 
:88 	
$str88
 
,88 
pattern99 
:99 
$str99 5
)995 6
;996 7
app:: 
.:: 
Run:: 
(:: 
):: 	
;::	 
Å
RC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Models\User.cs
	namespace 	
Group5_MusicPlayer
 
. 
Models #
{ 
public 

class 
User 
{ 
public 
int 
UserId 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
UserName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 
string		 
Phone		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
int

 
Role

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
public 
virtual 
ICollection "
<" #
Playlist# +
>+ ,
	Playlists- 6
{7 8
get9 <
;< =
set> A
;A B
}B C
public 
virtual 
ICollection "
<" #
Song# '
>' (
Songs) .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
} 
} Ô	
VC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Models\SongList.cs
	namespace 	
Group5_MusicPlayer
 
. 
Models #
{ 
public 

class 
SongList 
{ 
public 
int 

SongListId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
DateTime 
	AddedDate !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 

PlaylistId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
virtual 
Playlist 
Playlist  (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public		 
int		 
SongId		 
{		 
get		 
;		  
set		! $
;		$ %
}		% &
public

 
virtual

 
Song

 
Song

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
} 
} ü
RC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Models\Song.cs
	namespace 	
Group5_MusicPlayer
 
. 
Models #
{ 
public 

class 
Song 
{ 
public 
int 
SongId 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Title 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 

CategoryId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
virtual 
Category 
Category  (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public		 
int		 
AuthorId		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
virtual

 
User

 
Author

 "
{

# $
get

% (
;

( )
set

* -
;

- .
}

/ 0
public 
string 
ImgPath 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
	AudioPath 
{  !
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
	IsPrivate 
{ 
get  #
;# $
set% (
;( )
}* +
public 
virtual 
ICollection "
<" #
SongList# +
>+ ,
	SongLists- 6
{7 8
get9 <
;< =
set> A
;A B
}B C
} 
} Ü	
VC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Models\Playlist.cs
	namespace 	
Group5_MusicPlayer
 
. 
Models #
{ 
public 

class 
Playlist 
{ 
public 
int 

PlaylistId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Title 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
UserId 
{ 
get 
;  
set! $
;$ %
}& '
public 
virtual 
User 
User  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
virtual		 
ICollection		 "
<		" #
SongList		# +
>		+ ,
	SongLists		- 6
{		7 8
get		9 <
;		< =
set		> A
;		A B
}		B C
}

 
} ø
\C:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Models\ErrorViewModel.cs
	namespace 	
Group5_MusicPlayer
 
. 
Models #
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 ‚
VC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Models\Category.cs
	namespace 	
Group5_MusicPlayer
 
. 
Models #
{ 
public 

class 
Category 
{ 
public 
int 

CategoryId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
CategoryName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
virtual 
ICollection "
<" #
Song# '
>' (
Songs) .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
}		 
}

 †á
iC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Migrations\20231028035223_Innitial.cs
	namespace 	
Group5_MusicPlayer
 
. 

Migrations '
{ 
public		 

partial		 
class		 
Innitial		 !
:		" #
	Migration		$ -
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str "
," #
columns 
: 
table 
=> !
new" %
{ 

CategoryId 
=  
table! &
.& '
Column' -
<- .
int. 1
>1 2
(2 3
type3 7
:7 8
$str9 >
,> ?
nullable@ H
:H I
falseJ O
)O P
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
CategoryName  
=! "
table# (
.( )
Column) /
</ 0
string0 6
>6 7
(7 8
type8 <
:< =
$str> M
,M N
nullableO W
:W X
falseY ^
)^ _
,_ `
Description 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
type7 ;
:; <
$str= L
,L M
nullableN V
:V W
falseX ]
)] ^
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 4
,4 5
x6 7
=>8 :
x; <
.< =

CategoryId= G
)G H
;H I
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
UserId   
=   
table   "
.  " #
Column  # )
<  ) *
int  * -
>  - .
(  . /
type  / 3
:  3 4
$str  5 :
,  : ;
nullable  < D
:  D E
false  F K
)  K L
.!! 

Annotation!! #
(!!# $
$str!!$ 8
,!!8 9
$str!!: @
)!!@ A
,!!A B
UserName"" 
="" 
table"" $
.""$ %
Column""% +
<""+ ,
string"", 2
>""2 3
(""3 4
type""4 8
:""8 9
$str"": I
,""I J
nullable""K S
:""S T
false""U Z
)""Z [
,""[ \
Email## 
=## 
table## !
.##! "
Column##" (
<##( )
string##) /
>##/ 0
(##0 1
type##1 5
:##5 6
$str##7 F
,##F G
nullable##H P
:##P Q
false##R W
)##W X
,##X Y
Password$$ 
=$$ 
table$$ $
.$$$ %
Column$$% +
<$$+ ,
string$$, 2
>$$2 3
($$3 4
type$$4 8
:$$8 9
$str$$: I
,$$I J
nullable$$K S
:$$S T
false$$U Z
)$$Z [
,$$[ \
Phone%% 
=%% 
table%% !
.%%! "
Column%%" (
<%%( )
string%%) /
>%%/ 0
(%%0 1
type%%1 5
:%%5 6
$str%%7 F
,%%F G
nullable%%H P
:%%P Q
false%%R W
)%%W X
,%%X Y
Role&& 
=&& 
table&&  
.&&  !
Column&&! '
<&&' (
int&&( +
>&&+ ,
(&&, -
type&&- 1
:&&1 2
$str&&3 8
,&&8 9
nullable&&: B
:&&B C
false&&D I
)&&I J
}'' 
,'' 
constraints(( 
:(( 
table(( "
=>((# %
{)) 
table** 
.** 

PrimaryKey** $
(**$ %
$str**% /
,**/ 0
x**1 2
=>**3 5
x**6 7
.**7 8
UserId**8 >
)**> ?
;**? @
}++ 
)++ 
;++ 
migrationBuilder-- 
.-- 
CreateTable-- (
(--( )
name.. 
:.. 
$str.. !
,..! "
columns// 
:// 
table// 
=>// !
new//" %
{00 

PlaylistId11 
=11  
table11! &
.11& '
Column11' -
<11- .
int11. 1
>111 2
(112 3
type113 7
:117 8
$str119 >
,11> ?
nullable11@ H
:11H I
false11J O
)11O P
.22 

Annotation22 #
(22# $
$str22$ 8
,228 9
$str22: @
)22@ A
,22A B
Title33 
=33 
table33 !
.33! "
Column33" (
<33( )
string33) /
>33/ 0
(330 1
type331 5
:335 6
$str337 F
,33F G
nullable33H P
:33P Q
false33R W
)33W X
,33X Y
UserId44 
=44 
table44 "
.44" #
Column44# )
<44) *
int44* -
>44- .
(44. /
type44/ 3
:443 4
$str445 :
,44: ;
nullable44< D
:44D E
false44F K
)44K L
}55 
,55 
constraints66 
:66 
table66 "
=>66# %
{77 
table88 
.88 

PrimaryKey88 $
(88$ %
$str88% 3
,883 4
x885 6
=>887 9
x88: ;
.88; <

PlaylistId88< F
)88F G
;88G H
table99 
.99 

ForeignKey99 $
(99$ %
name:: 
::: 
$str:: 9
,::9 :
column;; 
:;; 
x;;  !
=>;;" $
x;;% &
.;;& '
UserId;;' -
,;;- .
principalTable<< &
:<<& '
$str<<( /
,<</ 0
principalColumn== '
:==' (
$str==) 1
,==1 2
onDelete>>  
:>>  !
ReferentialAction>>" 3
.>>3 4
Cascade>>4 ;
)>>; <
;>>< =
}?? 
)?? 
;?? 
migrationBuilderAA 
.AA 
CreateTableAA (
(AA( )
nameBB 
:BB 
$strBB 
,BB 
columnsCC 
:CC 
tableCC 
=>CC !
newCC" %
{DD 
SongIdEE 
=EE 
tableEE "
.EE" #
ColumnEE# )
<EE) *
intEE* -
>EE- .
(EE. /
typeEE/ 3
:EE3 4
$strEE5 :
,EE: ;
nullableEE< D
:EED E
falseEEF K
)EEK L
.FF 

AnnotationFF #
(FF# $
$strFF$ 8
,FF8 9
$strFF: @
)FF@ A
,FFA B
TitleGG 
=GG 
tableGG !
.GG! "
ColumnGG" (
<GG( )
stringGG) /
>GG/ 0
(GG0 1
typeGG1 5
:GG5 6
$strGG7 F
,GGF G
nullableGGH P
:GGP Q
falseGGR W
)GGW X
,GGX Y

CategoryIdHH 
=HH  
tableHH! &
.HH& '
ColumnHH' -
<HH- .
intHH. 1
>HH1 2
(HH2 3
typeHH3 7
:HH7 8
$strHH9 >
,HH> ?
nullableHH@ H
:HHH I
falseHHJ O
)HHO P
,HHP Q
AuthorIdII 
=II 
tableII $
.II$ %
ColumnII% +
<II+ ,
intII, /
>II/ 0
(II0 1
typeII1 5
:II5 6
$strII7 <
,II< =
nullableII> F
:IIF G
falseIIH M
)IIM N
,IIN O
ImgPathJJ 
=JJ 
tableJJ #
.JJ# $
ColumnJJ$ *
<JJ* +
stringJJ+ 1
>JJ1 2
(JJ2 3
typeJJ3 7
:JJ7 8
$strJJ9 H
,JJH I
nullableJJJ R
:JJR S
falseJJT Y
)JJY Z
,JJZ [
	AudioPathKK 
=KK 
tableKK  %
.KK% &
ColumnKK& ,
<KK, -
stringKK- 3
>KK3 4
(KK4 5
typeKK5 9
:KK9 :
$strKK; J
,KKJ K
nullableKKL T
:KKT U
falseKKV [
)KK[ \
,KK\ ]
	IsPrivateLL 
=LL 
tableLL  %
.LL% &
ColumnLL& ,
<LL, -
boolLL- 1
>LL1 2
(LL2 3
typeLL3 7
:LL7 8
$strLL9 >
,LL> ?
nullableLL@ H
:LLH I
falseLLJ O
)LLO P
}MM 
,MM 
constraintsNN 
:NN 
tableNN "
=>NN# %
{OO 
tablePP 
.PP 

PrimaryKeyPP $
(PP$ %
$strPP% /
,PP/ 0
xPP1 2
=>PP3 5
xPP6 7
.PP7 8
SongIdPP8 >
)PP> ?
;PP? @
tableQQ 
.QQ 

ForeignKeyQQ $
(QQ$ %
nameRR 
:RR 
$strRR >
,RR> ?
columnSS 
:SS 
xSS  !
=>SS" $
xSS% &
.SS& '

CategoryIdSS' 1
,SS1 2
principalTableTT &
:TT& '
$strTT( 4
,TT4 5
principalColumnUU '
:UU' (
$strUU) 5
,UU5 6
onDeleteVV  
:VV  !
ReferentialActionVV" 3
.VV3 4
CascadeVV4 ;
)VV; <
;VV< =
tableWW 
.WW 

ForeignKeyWW $
(WW$ %
nameXX 
:XX 
$strXX 7
,XX7 8
columnYY 
:YY 
xYY  !
=>YY" $
xYY% &
.YY& '
AuthorIdYY' /
,YY/ 0
principalTableZZ &
:ZZ& '
$strZZ( /
,ZZ/ 0
principalColumn[[ '
:[[' (
$str[[) 1
,[[1 2
onDelete\\  
:\\  !
ReferentialAction\\" 3
.\\3 4
Cascade\\4 ;
)\\; <
;\\< =
}]] 
)]] 
;]] 
migrationBuilder__ 
.__ 
CreateTable__ (
(__( )
name`` 
:`` 
$str`` !
,``! "
columnsaa 
:aa 
tableaa 
=>aa !
newaa" %
{bb 

SongListIdcc 
=cc  
tablecc! &
.cc& '
Columncc' -
<cc- .
intcc. 1
>cc1 2
(cc2 3
typecc3 7
:cc7 8
$strcc9 >
,cc> ?
nullablecc@ H
:ccH I
falseccJ O
)ccO P
.dd 

Annotationdd #
(dd# $
$strdd$ 8
,dd8 9
$strdd: @
)dd@ A
,ddA B
	AddedDateee 
=ee 
tableee  %
.ee% &
Columnee& ,
<ee, -
DateTimeee- 5
>ee5 6
(ee6 7
typeee7 ;
:ee; <
$stree= H
,eeH I
nullableeeJ R
:eeR S
trueeeT X
)eeX Y
,eeY Z

PlaylistIdff 
=ff  
tableff! &
.ff& '
Columnff' -
<ff- .
intff. 1
>ff1 2
(ff2 3
typeff3 7
:ff7 8
$strff9 >
,ff> ?
nullableff@ H
:ffH I
falseffJ O
)ffO P
,ffP Q
SongIdgg 
=gg 
tablegg "
.gg" #
Columngg# )
<gg) *
intgg* -
>gg- .
(gg. /
typegg/ 3
:gg3 4
$strgg5 :
,gg: ;
nullablegg< D
:ggD E
trueggF J
)ggJ K
}hh 
,hh 
constraintsii 
:ii 
tableii "
=>ii# %
{jj 
tablekk 
.kk 

PrimaryKeykk $
(kk$ %
$strkk% 3
,kk3 4
xkk5 6
=>kk7 9
xkk: ;
.kk; <

SongListIdkk< F
)kkF G
;kkG H
tablell 
.ll 

ForeignKeyll $
(ll$ %
namemm 
:mm 
$strmm A
,mmA B
columnnn 
:nn 
xnn  !
=>nn" $
xnn% &
.nn& '

PlaylistIdnn' 1
,nn1 2
principalTableoo &
:oo& '
$stroo( 3
,oo3 4
principalColumnpp '
:pp' (
$strpp) 5
,pp5 6
onDeleteqq  
:qq  !
ReferentialActionqq" 3
.qq3 4
Cascadeqq4 ;
)qq; <
;qq< =
tablerr 
.rr 

ForeignKeyrr $
(rr$ %
namess 
:ss 
$strss 9
,ss9 :
columntt 
:tt 
xtt  !
=>tt" $
xtt% &
.tt& '
SongIdtt' -
,tt- .
principalTableuu &
:uu& '
$struu( /
,uu/ 0
principalColumnvv '
:vv' (
$strvv) 1
,vv1 2
onDeleteww  
:ww  !
ReferentialActionww" 3
.ww3 4
NoActionww4 <
)ww< =
;ww= >
}xx 
)xx 
;xx 
migrationBuilderzz 
.zz 
CreateIndexzz (
(zz( )
name{{ 
:{{ 
$str{{ +
,{{+ ,
table|| 
:|| 
$str|| "
,||" #
column}} 
:}} 
$str}}  
)}}  !
;}}! "
migrationBuilder 
. 
CreateIndex (
(( )
name
ÄÄ 
:
ÄÄ 
$str
ÄÄ )
,
ÄÄ) *
table
ÅÅ 
:
ÅÅ 
$str
ÅÅ 
,
ÅÅ 
column
ÇÇ 
:
ÇÇ 
$str
ÇÇ "
)
ÇÇ" #
;
ÇÇ# $
migrationBuilder
ÑÑ 
.
ÑÑ 
CreateIndex
ÑÑ (
(
ÑÑ( )
name
ÖÖ 
:
ÖÖ 
$str
ÖÖ +
,
ÖÖ+ ,
table
ÜÜ 
:
ÜÜ 
$str
ÜÜ 
,
ÜÜ 
column
áá 
:
áá 
$str
áá $
)
áá$ %
;
áá% &
migrationBuilder
ââ 
.
ââ 
CreateIndex
ââ (
(
ââ( )
name
ää 
:
ää 
$str
ää /
,
ää/ 0
table
ãã 
:
ãã 
$str
ãã "
,
ãã" #
column
åå 
:
åå 
$str
åå $
)
åå$ %
;
åå% &
migrationBuilder
éé 
.
éé 
CreateIndex
éé (
(
éé( )
name
èè 
:
èè 
$str
èè +
,
èè+ ,
table
êê 
:
êê 
$str
êê "
,
êê" #
column
ëë 
:
ëë 
$str
ëë  
)
ëë  !
;
ëë! "
migrationBuilder
ìì 
.
ìì 
CreateIndex
ìì (
(
ìì( )
name
îî 
:
îî 
$str
îî &
,
îî& '
table
ïï 
:
ïï 
$str
ïï 
,
ïï 
column
ññ 
:
ññ 
$str
ññ 
,
ññ  
unique
óó 
:
óó 
true
óó 
)
óó 
;
óó 
}
òò 	
	protected
õõ 
override
õõ 
void
õõ 
Down
õõ  $
(
õõ$ %
MigrationBuilder
õõ% 5
migrationBuilder
õõ6 F
)
õõF G
{
úú 	
migrationBuilder
ùù 
.
ùù 
	DropTable
ùù &
(
ùù& '
name
ûû 
:
ûû 
$str
ûû !
)
ûû! "
;
ûû" #
migrationBuilder
†† 
.
†† 
	DropTable
†† &
(
††& '
name
°° 
:
°° 
$str
°° !
)
°°! "
;
°°" #
migrationBuilder
££ 
.
££ 
	DropTable
££ &
(
££& '
name
§§ 
:
§§ 
$str
§§ 
)
§§ 
;
§§ 
migrationBuilder
¶¶ 
.
¶¶ 
	DropTable
¶¶ &
(
¶¶& '
name
ßß 
:
ßß 
$str
ßß "
)
ßß" #
;
ßß# $
migrationBuilder
©© 
.
©© 
	DropTable
©© &
(
©©& '
name
™™ 
:
™™ 
$str
™™ 
)
™™ 
;
™™ 
}
´´ 	
}
¨¨ 
}≠≠ º7
`C:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Data\MusicPlayerDbContext.cs
	namespace 	
Group5_MusicPlayer
 
. 
Data !
{ 
public 

class  
MusicPlayerDbContext %
:& '
	DbContext( 1
{ 
public 
DbSet 
< 
User 
> 
Users  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
DbSet		 
<		 
Song		 
>		 
Songs		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
DbSet

 
<

 
Category

 
>

 

Categories

 )
{

* +
get

, /
;

/ 0
set

1 4
;

4 5
}

6 7
public 
DbSet 
< 
Playlist 
> 
	Playlists (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
DbSet 
< 
SongList 
> 
	SongsList (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public  
MusicPlayerDbContext #
(# $
DbContextOptions$ 4
options5 <
)< =
:> ?
base@ D
(D E
optionsE L
)L M
{ 	
} 	
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
modelBuilder 
. 
Entity 
<  
User  $
>$ %
(% &
)& '
.' (
HasKey( .
(. /
u/ 0
=>1 3
u4 5
.5 6
UserId6 <
)< =
;= >
modelBuilder 
. 
Entity 
<  
User  $
>$ %
(% &
)& '
.' (
HasIndex( 0
(0 1
u1 2
=>3 5
u6 7
.7 8
Email8 =
)= >
.> ?
IsUnique? G
(G H
)H I
;I J
modelBuilder 
. 
Entity 
<  
Category  (
>( )
() *
)* +
.+ ,
HasKey, 2
(2 3
c3 4
=>5 7
c8 9
.9 :

CategoryId: D
)D E
;E F
modelBuilder 
. 
Entity 
<  
Song  $
>$ %
(% &
)& '
.' (
HasKey( .
(. /
s/ 0
=>1 3
s4 5
.5 6
SongId6 <
)< =
;= >
modelBuilder 
. 
Entity 
<  
Song  $
>$ %
(% &
)& '
. 
HasOne 
( 
s 
=> 
s 
. 
Category '
)' (
.( )
WithMany) 1
(1 2
c2 3
=>4 6
c7 8
.8 9
Songs9 >
)> ?
.   
HasForeignKey   
(   
s    
=>  ! #
s  $ %
.  % &

CategoryId  & 0
)  0 1
.  1 2

IsRequired  2 <
(  < =
)  = >
;  > ?
modelBuilder!! 
.!! 
Entity!! 
<!!  
Song!!  $
>!!$ %
(!!% &
)!!& '
."" 
HasOne"" 
("" 
s"" 
=>"" 
s"" 
."" 
Author"" %
)""% &
.""& '
WithMany""' /
(""/ 0
u""0 1
=>""2 4
u""5 6
.""6 7
Songs""7 <
)""< =
.## 
HasForeignKey## 
(## 
s##  
=>##! #
s##$ %
.##% &
AuthorId##& .
)##. /
.##/ 0

IsRequired##0 :
(##: ;
)##; <
;##< =
modelBuilder&& 
.&& 
Entity&& 
<&&  
Playlist&&  (
>&&( )
(&&) *
)&&* +
.&&+ ,
HasKey&&, 2
(&&2 3
s&&3 4
=>&&5 7
s&&8 9
.&&9 :

PlaylistId&&: D
)&&D E
;&&E F
modelBuilder'' 
.'' 
Entity'' 
<''  
Playlist''  (
>''( )
('') *
)''* +
.(( 
HasOne(( 
((( 
p(( 
=>(( 
p(( 
.(( 
User(( "
)((" #
.((# $
WithMany(($ ,
(((, -
u((- .
=>((/ 1
u((2 3
.((3 4
	Playlists((4 =
)((= >
.)) 
HasForeignKey)) 
()) 
p)) 
=>))  "
p))# $
.))$ %
UserId))% +
)))+ ,
.)), -

IsRequired))- 7
())7 8
)))8 9
;))9 :
modelBuilder,, 
.,, 
Entity,, 
<,,  
SongList,,  (
>,,( )
(,,) *
),,* +
.,,+ ,
HasKey,,, 2
(,,2 3
s,,3 4
=>,,5 7
s,,8 9
.,,9 :

SongListId,,: D
),,D E
;,,E F
modelBuilder-- 
.-- 
Entity-- 
<--  
SongList--  (
>--( )
(--) *
)--* +
... 
HasOne.. 
(.. 
s.. 
=>.. 
s.. 
... 
Playlist.. '
)..' (
...( )
WithMany..) 1
(..1 2
p..2 3
=>..4 6
p..7 8
...8 9
	SongLists..9 B
)..B C
.// 
HasForeignKey// 
(// 
s//  
=>//! #
s//$ %
.//% &

PlaylistId//& 0
)//0 1
.//1 2

IsRequired//2 <
(//< =
)//= >
;//> ?
modelBuilder00 
.00 
Entity00 
<00  
SongList00  (
>00( )
(00) *
)00* +
.11 
HasOne11 
(11 
s11 
=>11 
s11 
.11 
Song11 #
)11# $
.11$ %
WithMany11% -
(11- .
s11. /
=>110 2
s113 4
.114 5
	SongLists115 >
)11> ?
.22 
HasForeignKey22 
(22 
s22  
=>22! #
s22$ %
.22% &
SongId22& ,
)22, -
.22- .

IsRequired22. 8
(228 9
)229 :
;22: ;
}33 	
}44 
}55 ƒW
bC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Controllers\UsersController.cs
	namespace 	
Group5_MusicPlayer
 
. 
Controllers (
{ 
public 

class 
UsersController  
:! "

Controller# -
{ 
private 
readonly  
MusicPlayerDbContext -
_context. 6
;6 7
private 
readonly 
IHubContext $
<$ %
SignalrServer% 2
>2 3
_signalRHub4 ?
;? @
public 
UsersController 
(  
MusicPlayerDbContext 3
context4 ;
,; <
IHubContext= H
<H I
SignalrServerI V
>V W

signalRHubX b
)b c
{ 	
_context 
= 
context 
; 
_signalRHub 
= 

signalRHub $
;$ %
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
var 
account 
= 
HttpContext %
.% &
Session& -
.- .
	GetString. 7
(7 8
$str8 A
)A B
;B C
if 
( 
account 
!= 
$str "
)" #
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 7
)7 8
;8 9
return   
_context   
.   
Users   !
!=  " $
null  % )
?  * +
View!! 
(!! 
await!! "
_context!!# +
.!!+ ,
Users!!, 1
.!!1 2
ToListAsync!!2 =
(!!= >
)!!> ?
)!!? @
:!!A B
Problem"" 
(""  
$str""  S
)""S T
;""T U
}## 	
public&& 
async&& 
Task&& 
<&& 
IActionResult&& '
>&&' (
Details&&) 0
(&&0 1
int&&1 4
?&&4 5
id&&6 8
)&&8 9
{'' 	
if(( 
((( 
id(( 
==(( 
null(( 
||(( 
_context(( &
.((& '
Users((' ,
==((- /
null((0 4
)((4 5
{)) 
return** 
NotFound** 
(**  
)**  !
;**! "
}++ 
var-- 
user-- 
=-- 
await-- 
_context-- %
.--% &
Users--& +
... 
FirstOrDefaultAsync.. $
(..$ %
m..% &
=>..' )
m..* +
...+ ,
UserId.., 2
==..3 5
id..6 8
)..8 9
;..9 :
if// 
(// 
user// 
==// 
null// 
)// 
{00 
return11 
NotFound11 
(11  
)11  !
;11! "
}22 
return44 
View44 
(44 
user44 
)44 
;44 
}55 	
public88 
IActionResult88 
Create88 #
(88# $
)88$ %
{99 	
return:: 
View:: 
(:: 
):: 
;:: 
};; 	
[@@ 	
HttpPost@@	 
]@@ 
[AA 	$
ValidateAntiForgeryTokenAA	 !
]AA! "
publicBB 
asyncBB 
TaskBB 
<BB 
IActionResultBB '
>BB' (
CreateBB) /
(BB/ 0
[BB0 1
BindBB1 5
(BB5 6
$strBB6 a
)BBa b
]BBb c
UserBBd h
userBBi m
)BBm n
{CC 	
_contextEE 
.EE 
AddEE 
(EE 
userEE 
)EE 
;EE 
awaitFF 
_contextFF 
.FF 
SaveChangesAsyncFF +
(FF+ ,
)FF, -
;FF- .
PlaylistII 
playlistII 
=II 
newII  #
PlaylistII$ ,
(II, -
)II- .
{JJ 
TitleKK 
=KK 
$strKK +
,KK+ ,
UserIdLL 
=LL 
userLL 
.LL 
UserIdLL $
}MM 
;MM 
_contextNN 
.NN 
AddNN 
(NN 
playlistNN !
)NN! "
;NN" #
awaitOO 
_contextOO 
.OO 
SaveChangesAsyncOO +
(OO+ ,
)OO, -
;OO- .
returnRR 
RedirectToActionRR #
(RR# $
nameofRR$ *
(RR* +
IndexRR+ 0
)RR0 1
)RR1 2
;RR2 3
}SS 	
publicVV 
asyncVV 
TaskVV 
<VV 
IActionResultVV '
>VV' (
EditVV) -
(VV- .
intVV. 1
?VV1 2
idVV3 5
)VV5 6
{WW 	
ifXX 
(XX 
idXX 
==XX 
nullXX 
||XX 
_contextXX &
.XX& '
UsersXX' ,
==XX- /
nullXX0 4
)XX4 5
{YY 
returnZZ 
NotFoundZZ 
(ZZ  
)ZZ  !
;ZZ! "
}[[ 
var]] 
user]] 
=]] 
await]] 
_context]] %
.]]% &
Users]]& +
.]]+ ,
	FindAsync]], 5
(]]5 6
id]]6 8
)]]8 9
;]]9 :
if^^ 
(^^ 
user^^ 
==^^ 
null^^ 
)^^ 
{__ 
return`` 
NotFound`` 
(``  
)``  !
;``! "
}aa 
returnbb 
Viewbb 
(bb 
userbb 
)bb 
;bb 
}cc 	
[hh 	
HttpPosthh	 
]hh 
[ii 	$
ValidateAntiForgeryTokenii	 !
]ii! "
publicjj 
asyncjj 
Taskjj 
<jj 
IActionResultjj '
>jj' (
Editjj) -
(jj- .
intjj. 1
?jj1 2
idjj3 5
,jj5 6
[jj7 8
Bindjj8 <
(jj< =
$strjj= h
)jjh i
]jji j
Userjjk o
userjjp t
)jjt u
{kk 	
tryll 
{mm 
_contextnn 
.nn 
Updatenn 
(nn  
usernn  $
)nn$ %
;nn% &
awaitoo 
_contextoo 
.oo 
SaveChangesAsyncoo /
(oo/ 0
)oo0 1
;oo1 2
}pp 
catchqq 
(qq (
DbUpdateConcurrencyExceptionqq /
)qq/ 0
{rr 
ifss 
(ss 
!ss 

UserExistsss 
(ss  
userss  $
.ss$ %
UserIdss% +
)ss+ ,
)ss, -
{tt 
returnuu 
NotFounduu #
(uu# $
)uu$ %
;uu% &
}vv 
elseww 
{xx 
throwyy 
;yy 
}zz 
}{{ 
return|| 
RedirectToAction|| #
(||# $
nameof||$ *
(||* +
Index||+ 0
)||0 1
)||1 2
;||2 3
}}} 	
public
ÄÄ 
async
ÄÄ 
Task
ÄÄ 
<
ÄÄ 
IActionResult
ÄÄ '
>
ÄÄ' (
Delete
ÄÄ) /
(
ÄÄ/ 0
int
ÄÄ0 3
?
ÄÄ3 4
id
ÄÄ5 7
)
ÄÄ7 8
{
ÅÅ 	
if
ÇÇ 
(
ÇÇ 
id
ÇÇ 
==
ÇÇ 
null
ÇÇ 
||
ÇÇ 
_context
ÇÇ &
.
ÇÇ& '
Users
ÇÇ' ,
==
ÇÇ- /
null
ÇÇ0 4
)
ÇÇ4 5
{
ÉÉ 
return
ÑÑ 
NotFound
ÑÑ 
(
ÑÑ  
)
ÑÑ  !
;
ÑÑ! "
}
ÖÖ 
var
áá 
user
áá 
=
áá 
await
áá 
_context
áá %
.
áá% &
Users
áá& +
.
àà !
FirstOrDefaultAsync
àà $
(
àà$ %
m
àà% &
=>
àà' )
m
àà* +
.
àà+ ,
UserId
àà, 2
==
àà3 5
id
àà6 8
)
àà8 9
;
àà9 :
if
ââ 
(
ââ 
user
ââ 
==
ââ 
null
ââ 
)
ââ 
{
ää 
return
ãã 
NotFound
ãã 
(
ãã  
)
ãã  !
;
ãã! "
}
åå 
return
éé 
View
éé 
(
éé 
user
éé 
)
éé 
;
éé 
}
èè 	
[
íí 	
HttpPost
íí	 
,
íí 

ActionName
íí 
(
íí 
$str
íí &
)
íí& '
]
íí' (
[
ìì 	&
ValidateAntiForgeryToken
ìì	 !
]
ìì! "
public
îî 
async
îî 
Task
îî 
<
îî 
IActionResult
îî '
>
îî' (
DeleteConfirmed
îî) 8
(
îî8 9
int
îî9 <
id
îî= ?
)
îî? @
{
ïï 	
if
ññ 
(
ññ 
_context
ññ 
.
ññ 
Users
ññ 
==
ññ !
null
ññ" &
)
ññ& '
{
óó 
return
òò 
Problem
òò 
(
òò 
$str
òò R
)
òòR S
;
òòS T
}
ôô 
var
öö 
user
öö 
=
öö 
await
öö 
_context
öö %
.
öö% &
Users
öö& +
.
öö+ ,
	FindAsync
öö, 5
(
öö5 6
id
öö6 8
)
öö8 9
;
öö9 :
if
õõ 
(
õõ 
user
õõ 
!=
õõ 
null
õõ 
)
õõ 
{
úú 
_context
ùù 
.
ùù 
Users
ùù 
.
ùù 
Remove
ùù %
(
ùù% &
user
ùù& *
)
ùù* +
;
ùù+ ,
}
ûû 
await
†† 
_context
†† 
.
†† 
SaveChangesAsync
†† +
(
††+ ,
)
††, -
;
††- .
return
°° 
RedirectToAction
°° #
(
°°# $
nameof
°°$ *
(
°°* +
Index
°°+ 0
)
°°0 1
)
°°1 2
;
°°2 3
}
¢¢ 	
private
§§ 
bool
§§ 

UserExists
§§ 
(
§§  
int
§§  #
id
§§$ &
)
§§& '
{
•• 	
return
¶¶ 
(
¶¶ 
_context
¶¶ 
.
¶¶ 
Users
¶¶ "
?
¶¶" #
.
¶¶# $
Any
¶¶$ '
(
¶¶' (
e
¶¶( )
=>
¶¶* ,
e
¶¶- .
.
¶¶. /
UserId
¶¶/ 5
==
¶¶6 8
id
¶¶9 ;
)
¶¶; <
)
¶¶< =
.
¶¶= >
GetValueOrDefault
¶¶> O
(
¶¶O P
)
¶¶P Q
;
¶¶Q R
}
ßß 	
}
®® 
}©© …P
jC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Controllers\AuthorizationController.cs
	namespace 	
Group5_MusicPlayer
 
. 
Controllers (
{		 
public

 

class

 #
AuthorizationController

 (
:

) *

Controller

+ 5
{ 
private 
readonly  
MusicPlayerDbContext -
context. 5
;5 6
public #
AuthorizationController &
(& ' 
MusicPlayerDbContext' ;
context1< D
)D E
{ 	
context 
= 
context1 
; 
} 	
public 
IActionResult 
Login "
(" #
)# $
{ 	
return 
View 
( 
$str <
)< =
;= >
} 	
[ 	
HttpPost	 
] 
public 
IActionResult 
Login "
(" #
string# )
email* /
,/ 0
string1 7
password8 @
)@ A
{ 	
User 
user 
= 
context 
.  
Users  %
.% &
FirstOrDefault& 4
(4 5
x5 6
=>7 9
x: ;
.; <
Email< A
==B D
emailE J
&&8 :
x; <
.< =
Password= E
==F H
passwordI Q
)Q R
;R S
if 
( 
user 
== 
null 
) 
{ 
ViewBag 
. 
error 
= 
$str  M
;M N
return 
View 
( 
$str @
)@ A
;A B
}   
if!! 
(!! 
user!! 
.!! 
Role!! 
==!! 
$num!! 
)!! 
{"" 
ViewBag## 
.## 
error## 
=## 
$str##  g
;##g h
return$$ 
View$$ 
($$ 
$str$$ @
)$$@ A
;$$A B
}%% 
if(( 
((( 
user(( 
.(( 
Role(( 
==(( 
$num(( 
)(( 
{)) 
HttpContext** 
.** 
Session** #
.**# $
	SetString**$ -
(**- .
$str**. 7
,**7 8
$str**9 @
)**@ A
;**A B
return++ 
RedirectToAction++ '
(++' (
$str++( /
,++/ 0
$str++1 7
)++7 8
;++8 9
},, 
HttpContext-- 
.-- 
Session-- 
.--  
	SetString--  )
(--) *
$str--* 3
,--3 4
$str--5 ;
)--; <
;--< =
HttpContext.. 
... 
Session.. 
...  
	SetString..  )
(..) *
$str..* .
,... /
user..0 4
...4 5
UserId..5 ;
...; <
ToString..< D
(..D E
)..E F
)..F G
;..G H
return// 
RedirectToAction// #
(//# $
$str//$ +
,//+ ,
$str//- 3
)//3 4
;//4 5
}11 	
public33 
IActionResult33 
Register33 %
(33% &
)33& '
{44 	
return55 
View55 
(55 
$str55 ?
)55? @
;55@ A
}66 	
[77 	
HttpPost77	 
]77 
public88 
IActionResult88 
Register88 %
(88% &
string88& ,
username88- 5
,885 6
string887 =
email88> C
,88C D
string88E K
password88L T
,88T U
string88V \
confirmPassword88] l
,88l m
string88n t
phone88u z
)88z {
{99 	
User:: 
existingEmail:: 
=::  
context::! (
.::( )
Users::) .
.::. /
FirstOrDefault::/ =
(::= >
u::> ?
=>::@ B
u::C D
.::D E
Email::E J
==::K M
email::N S
)::S T
;::T U
if;; 
(;; 
existingEmail;; 
!=;;  
null;;! %
);;% &
{<< 
ViewBag== 
.== 
MessageError== $
===% &
$str==' 5
;==5 6
return>> 
View>> 
(>> 
$str>> C
)>>C D
;>>D E
}?? 
if@@ 
(@@ 
!@@ 
isValidEmail@@ 
(@@ 
email@@ #
)@@# $
)@@$ %
{AA 
ViewBagBB 
.BB 
MessageErrorBB $
=BB% &
$strBB' 7
;BB7 8
returnCC 
ViewCC 
(CC 
$strCC C
)CCC D
;CCD E
}DD 
ifEE 
(EE 
passwordEE 
.EE 
LengthEE 
<EE  !
$numEE" #
)EE# $
{FF 
ViewBagGG 
.GG 
MessageErrorGG $
=GG% &
$strGG' R
;GGR S
returnHH 
ViewHH 
(HH 
$strHH C
)HHC D
;HHD E
}II 
ifKK 
(KK 
!KK 
passwordKK 
.KK 
EqualsKK  
(KK  !
confirmPasswordKK! 0
)KK0 1
)KK1 2
{LL 
ViewBagMM 
.MM 
MessageErrorMM $
=MM% &
$strMM' P
;MMP Q
returnNN 
ViewNN 
(NN 
$strNN C
)NNC D
;NND E
}OO 
tryPP 
{QQ 
UserRR 
appUserRR 
=RR 
newRR "
UserRR# '
(RR' (
)RR( )
{SS 
UserNameTT 
=TT 
usernameTT '
,TT' (
EmailUU 
=UU 
emailUU !
,UU! "
PasswordVV 
=VV 
passwordVV '
,VV' (
PhoneWW 
=WW 
phoneWW !
,WW! "
RoleXX 
=XX 
$numXX 
}YY 
;YY 
contextZZ 
.ZZ 
AddZZ 
(ZZ 
appUserZZ #
)ZZ# $
;ZZ$ %
context[[ 
.[[ 
SaveChanges[[ #
([[# $
)[[$ %
;[[% &
User\\ 
userToAddPlaylist\\ &
=\\' (
context\\) 0
.\\0 1
Users\\1 6
.\\6 7
FirstOrDefault\\7 E
(\\E F
u\\F G
=>\\H J
u\\K L
.\\L M
Email\\M R
==\\S U
email\\V [
)\\[ \
;\\\ ]
Playlist]] 
playlist]] !
=]]" #
new]]$ '
Playlist]]( 0
(]]0 1
)]]1 2
{^^ 
Title__ 
=__ 
$str__ /
,__/ 0
UserId`` 
=`` 
userToAddPlaylist`` .
.``. /
UserId``/ 5
}aa 
;aa 
contextbb 
.bb 
Addbb 
(bb 
playlistbb $
)bb$ %
;bb% &
contextcc 
.cc 
SaveChangescc #
(cc# $
)cc$ %
;cc% &
ViewBagdd 
.dd 
RegisterMessagedd '
=dd( )
$strdd* C
;ddC D
returnee 
Viewee 
(ee 
$stree @
)ee@ A
;eeA B
}ff 
catchgg 
(gg 
	Exceptiongg 
exgg 
)gg  
{hh 
ViewBagii 
.ii 
MessageErrorii $
=ii% &
usernameii' /
+ii0 1
$strii2 5
+ii6 7
phoneii8 =
+ii> ?
$strii@ C
+iiD E
emailiiF K
+iiL M
$striiN Q
+iiR S
passwordiiT \
;ii\ ]
returnjj 
Viewjj 
(jj 
$strjj C
)jjC D
;jjD E
}kk 
}ll 	
publicnn 
IActionResultnn 
Logoutnn #
(nn# $
)nn$ %
{oo 	
varpp 
userpp 
=pp 
HttpContextpp "
.pp" #
Sessionpp# *
.pp* +
	GetStringpp+ 4
(pp4 5
$strpp5 >
)pp> ?
;pp? @
ifqq 
(qq 
userqq 
!=qq 
nullqq 
)qq 
{rr 
HttpContextss 
.ss 
Sessionss #
.ss# $
Clearss$ )
(ss) *
)ss* +
;ss+ ,
}tt 
varuu 
userIDuu 
=uu 
HttpContextuu $
.uu$ %
Sessionuu% ,
.uu, -
	GetStringuu- 6
(uu6 7
$struu7 ;
)uu; <
;uu< =
ifvv 
(vv 
userIDvv 
!=vv 
nullvv 
)vv 
{ww 
HttpContextxx 
.xx 
Sessionxx #
.xx# $
Clearxx$ )
(xx) *
)xx* +
;xx+ ,
}yy 
returnzz 
RedirectToActionzz #
(zz# $
$strzz$ +
,zz+ ,
$strzz- 3
)zz3 4
;zz4 5
}{{ 	
bool}} 
isValidEmail}} 
(}} 
string}}  
input}}! &
)}}& '
{~~ 	
try 
{
ÄÄ 
var
ÅÅ 
email
ÅÅ 
=
ÅÅ 
new
ÅÅ 
System
ÅÅ  &
.
ÅÅ& '
Net
ÅÅ' *
.
ÅÅ* +
Mail
ÅÅ+ /
.
ÅÅ/ 0
MailAddress
ÅÅ0 ;
(
ÅÅ; <
input
ÅÅ< A
)
ÅÅA B
;
ÅÅB C
return
ÇÇ 
true
ÇÇ 
;
ÇÇ 
}
ÉÉ 
catch
ÑÑ 
{
ÖÖ 
return
ÜÜ 
false
ÜÜ 
;
ÜÜ 
}
áá 
}
àà 	
}
ãã 
}åå £m
fC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Controllers\SongListsController.cs
	namespace 	
Group5_MusicPlayer
 
. 
Controllers (
{ 
public 

class 
SongListsController $
:% &

Controller' 1
{ 
private 
readonly  
MusicPlayerDbContext -
_context. 6
;6 7
private 
readonly 
IHubContext $
<$ %
SignalrServer% 2
>2 3
_signalRHub4 ?
;? @
public 
SongListsController "
(" # 
MusicPlayerDbContext# 7
context8 ?
,? @
IHubContextA L
<L M
SignalrServerM Z
>Z [

signalRHub\ f
)f g
{ 	
_context 
= 
context 
; 
_signalRHub 
= 

signalRHub $
;$ %
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
var 
account 
= 
HttpContext %
.% &
Session& -
.- .
	GetString. 7
(7 8
$str8 A
)A B
;B C
if 
( 
account 
!= 
$str "
)" #
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 7
)7 8
;8 9
var    
musicPlayerDbContext   $
=  % &
_context  ' /
.  / 0
	SongsList  0 9
.  9 :
Include  : A
(  A B
s  B C
=>  D F
s  G H
.  H I
Playlist  I Q
)  Q R
.  R S
Include  S Z
(  Z [
s  [ \
=>  ] _
s  ` a
.  a b
Song  b f
)  f g
;  g h
return!! 
View!! 
(!! 
await!!  
musicPlayerDbContext!! 2
.!!2 3
ToListAsync!!3 >
(!!> ?
)!!? @
)!!@ A
;!!A B
}"" 	
public&& 
async&& 
Task&& 
<&& 
IActionResult&& '
>&&' (
Details&&) 0
(&&0 1
int&&1 4
?&&4 5
id&&6 8
)&&8 9
{'' 	
if(( 
((( 
id(( 
==(( 
null(( 
||(( 
_context(( &
.((& '
	SongsList((' 0
==((1 3
null((4 8
)((8 9
{)) 
return** 
NotFound** 
(**  
)**  !
;**! "
}++ 
var-- 
songList-- 
=-- 
await--  
_context--! )
.--) *
	SongsList--* 3
... 
Include.. 
(.. 
s.. 
=>.. 
s.. 
...  
Playlist..  (
)..( )
.// 
Include// 
(// 
s// 
=>// 
s// 
.//  
Song//  $
)//$ %
.00 
FirstOrDefaultAsync00 $
(00$ %
m00% &
=>00' )
m00* +
.00+ ,

SongListId00, 6
==007 9
id00: <
)00< =
;00= >
if11 
(11 
songList11 
==11 
null11  
)11  !
{22 
return33 
NotFound33 
(33  
)33  !
;33! "
}44 
return66 
View66 
(66 
songList66  
)66  !
;66! "
}77 	
public:: 
IActionResult:: 
Create:: #
(::# $
)::$ %
{;; 	
ViewData<< 
[<< 
$str<< !
]<<! "
=<<# $
new<<% (

SelectList<<) 3
(<<3 4
_context<<4 <
.<<< =
	Playlists<<= F
,<<F G
$str<<H T
,<<T U
$str<<V b
)<<b c
;<<c d
ViewData== 
[== 
$str== 
]== 
===  
new==! $

SelectList==% /
(==/ 0
_context==0 8
.==8 9
Songs==9 >
,==> ?
$str==@ H
,==H I
$str==J R
)==R S
;==S T
return>> 
View>> 
(>> 
)>> 
;>> 
}?? 	
[DD 	
HttpPostDD	 
]DD 
[EE 	$
ValidateAntiForgeryTokenEE	 !
]EE! "
publicFF 
asyncFF 
TaskFF 
<FF 
IActionResultFF '
>FF' (
CreateFF) /
(FF/ 0
[FF0 1
BindFF1 5
(FF5 6
$strFF6 ^
)FF^ _
]FF_ `
SongListFFa i
songListFFj r
)FFr s
{GG 	
_contextHH 
.HH 
AddHH 
(HH 
songListHH %
)HH% &
;HH& '
awaitII 
_contextII 
.II 
SaveChangesAsyncII /
(II/ 0
)II0 1
;II1 2
returnJJ 
RedirectToActionJJ '
(JJ' (
nameofJJ( .
(JJ. /
IndexJJ/ 4
)JJ4 5
)JJ5 6
;JJ6 7
}KK 	
publicNN 
asyncNN 
TaskNN 
<NN 
IActionResultNN '
>NN' (
EditNN) -
(NN- .
intNN. 1
?NN1 2
idNN3 5
)NN5 6
{OO 	
ifPP 
(PP 
idPP 
==PP 
nullPP 
||PP 
_contextPP &
.PP& '
	SongsListPP' 0
==PP1 3
nullPP4 8
)PP8 9
{QQ 
returnRR 
NotFoundRR 
(RR  
)RR  !
;RR! "
}SS 
varUU 
songListUU 
=UU 
awaitUU  
_contextUU! )
.UU) *
	SongsListUU* 3
.UU3 4
	FindAsyncUU4 =
(UU= >
idUU> @
)UU@ A
;UUA B
ifVV 
(VV 
songListVV 
==VV 
nullVV  
)VV  !
{WW 
returnXX 
NotFoundXX 
(XX  
)XX  !
;XX! "
}YY 
ViewDataZZ 
[ZZ 
$strZZ !
]ZZ! "
=ZZ# $
newZZ% (

SelectListZZ) 3
(ZZ3 4
_contextZZ4 <
.ZZ< =
	PlaylistsZZ= F
,ZZF G
$strZZH T
,ZZT U
$strZZV b
,ZZb c
songListZZd l
.ZZl m

PlaylistIdZZm w
)ZZw x
;ZZx y
ViewData[[ 
[[[ 
$str[[ 
][[ 
=[[  
new[[! $

SelectList[[% /
([[/ 0
_context[[0 8
.[[8 9
Songs[[9 >
,[[> ?
$str[[@ H
,[[H I
$str[[J R
,[[R S
songList[[T \
.[[\ ]
SongId[[] c
)[[c d
;[[d e
return\\ 
View\\ 
(\\ 
songList\\  
)\\  !
;\\! "
}]] 	
[bb 	
HttpPostbb	 
]bb 
[cc 	$
ValidateAntiForgeryTokencc	 !
]cc! "
publicdd 
asyncdd 
Taskdd 
<dd 
IActionResultdd '
>dd' (
Editdd) -
(dd- .
intdd. 1
?dd1 2
iddd3 5
,dd5 6
[dd7 8
Binddd8 <
(dd< =
$strdd= e
)dde f
]ddf g
SongListddh p
songListddq y
)ddy z
{ee 	
ifkk 
(kk 

ModelStatekk 
.kk 
IsValidkk "
)kk" #
{ll 
trymm 
{nn 
_contextoo 
.oo 
Updateoo #
(oo# $
songListoo$ ,
)oo, -
;oo- .
awaitpp 
_contextpp "
.pp" #
SaveChangesAsyncpp# 3
(pp3 4
)pp4 5
;pp5 6
}qq 
catchrr 
(rr (
DbUpdateConcurrencyExceptionrr 3
)rr3 4
{ss 
iftt 
(tt 
!tt 
SongListExiststt '
(tt' (
songListtt( 0
.tt0 1

SongListIdtt1 ;
)tt; <
)tt< =
{uu 
returnvv 
NotFoundvv '
(vv' (
)vv( )
;vv) *
}ww 
elsexx 
{yy 
throwzz 
;zz 
}{{ 
}|| 
return}} 
RedirectToAction}} '
(}}' (
nameof}}( .
(}}. /
Index}}/ 4
)}}4 5
)}}5 6
;}}6 7
}~~ 
ViewData 
[ 
$str !
]! "
=# $
new% (

SelectList) 3
(3 4
_context4 <
.< =
	Playlists= F
,F G
$strH T
,T U
$strV b
,b c
songListd l
.l m

PlaylistIdm w
)w x
;x y
ViewData
ÄÄ 
[
ÄÄ 
$str
ÄÄ 
]
ÄÄ 
=
ÄÄ  
new
ÄÄ! $

SelectList
ÄÄ% /
(
ÄÄ/ 0
_context
ÄÄ0 8
.
ÄÄ8 9
Songs
ÄÄ9 >
,
ÄÄ> ?
$str
ÄÄ@ H
,
ÄÄH I
$str
ÄÄJ R
,
ÄÄR S
songList
ÄÄT \
.
ÄÄ\ ]
SongId
ÄÄ] c
)
ÄÄc d
;
ÄÄd e
return
ÅÅ 
View
ÅÅ 
(
ÅÅ 
songList
ÅÅ  
)
ÅÅ  !
;
ÅÅ! "
}
ÇÇ 	
public
ÖÖ 
async
ÖÖ 
Task
ÖÖ 
<
ÖÖ 
IActionResult
ÖÖ '
>
ÖÖ' (
Delete
ÖÖ) /
(
ÖÖ/ 0
int
ÖÖ0 3
?
ÖÖ3 4
id
ÖÖ5 7
)
ÖÖ7 8
{
ÜÜ 	
if
áá 
(
áá 
id
áá 
==
áá 
null
áá 
||
áá 
_context
áá &
.
áá& '
	SongsList
áá' 0
==
áá1 3
null
áá4 8
)
áá8 9
{
àà 
return
ââ 
NotFound
ââ 
(
ââ  
)
ââ  !
;
ââ! "
}
ää 
var
åå 
songList
åå 
=
åå 
await
åå  
_context
åå! )
.
åå) *
	SongsList
åå* 3
.
çç 
Include
çç 
(
çç 
s
çç 
=>
çç 
s
çç 
.
çç  
Playlist
çç  (
)
çç( )
.
éé 
Include
éé 
(
éé 
s
éé 
=>
éé 
s
éé 
.
éé  
Song
éé  $
)
éé$ %
.
èè !
FirstOrDefaultAsync
èè $
(
èè$ %
m
èè% &
=>
èè' )
m
èè* +
.
èè+ ,

SongListId
èè, 6
==
èè7 9
id
èè: <
)
èè< =
;
èè= >
if
êê 
(
êê 
songList
êê 
==
êê 
null
êê  
)
êê  !
{
ëë 
return
íí 
NotFound
íí 
(
íí  
)
íí  !
;
íí! "
}
ìì 
return
ïï 
View
ïï 
(
ïï 
songList
ïï  
)
ïï  !
;
ïï! "
}
ññ 	
[
ôô 	
HttpPost
ôô	 
,
ôô 

ActionName
ôô 
(
ôô 
$str
ôô &
)
ôô& '
]
ôô' (
[
öö 	&
ValidateAntiForgeryToken
öö	 !
]
öö! "
public
õõ 
async
õõ 
Task
õõ 
<
õõ 
IActionResult
õõ '
>
õõ' (
DeleteConfirmed
õõ) 8
(
õõ8 9
int
õõ9 <
id
õõ= ?
)
õõ? @
{
úú 	
if
ùù 
(
ùù 
_context
ùù 
.
ùù 
	SongsList
ùù "
==
ùù# %
null
ùù& *
)
ùù* +
{
ûû 
return
üü 
Problem
üü 
(
üü 
$str
üü V
)
üüV W
;
üüW X
}
†† 
var
°° 
songList
°° 
=
°° 
await
°°  
_context
°°! )
.
°°) *
	SongsList
°°* 3
.
°°3 4
	FindAsync
°°4 =
(
°°= >
id
°°> @
)
°°@ A
;
°°A B
if
¢¢ 
(
¢¢ 
songList
¢¢ 
!=
¢¢ 
null
¢¢  
)
¢¢  !
{
££ 
_context
§§ 
.
§§ 
	SongsList
§§ "
.
§§" #
Remove
§§# )
(
§§) *
songList
§§* 2
)
§§2 3
;
§§3 4
}
•• 
await
ßß 
_context
ßß 
.
ßß 
SaveChangesAsync
ßß +
(
ßß+ ,
)
ßß, -
;
ßß- .
return
®® 
RedirectToAction
®® #
(
®®# $
nameof
®®$ *
(
®®* +
Index
®®+ 0
)
®®0 1
)
®®1 2
;
®®2 3
}
©© 	
private
´´ 
bool
´´ 
SongListExists
´´ #
(
´´# $
int
´´$ '
id
´´( *
)
´´* +
{
¨¨ 	
return
≠≠
 
(
≠≠ 
_context
≠≠ 
.
≠≠ 
	SongsList
≠≠ $
?
≠≠$ %
.
≠≠% &
Any
≠≠& )
(
≠≠) *
e
≠≠* +
=>
≠≠, .
e
≠≠/ 0
.
≠≠0 1

SongListId
≠≠1 ;
==
≠≠< >
id
≠≠? A
)
≠≠A B
)
≠≠B C
.
≠≠C D
GetValueOrDefault
≠≠D U
(
≠≠U V
)
≠≠V W
;
≠≠W X
}
ÆÆ 	
}
ØØ 
}∞∞ éo
fC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Controllers\PlaylistsController.cs
	namespace 	
Group5_MusicPlayer
 
. 
Controllers (
{ 
public 

class 
PlaylistsController $
:% &

Controller' 1
{ 
private 
readonly  
MusicPlayerDbContext -
_context. 6
;6 7
private 
readonly 
IHubContext $
<$ %
SignalrServer% 2
>2 3
_signalRHub4 ?
;? @
public 
PlaylistsController "
(" # 
MusicPlayerDbContext# 7
context8 ?
,? @
IHubContextA L
<L M
SignalrServerM Z
>Z [

signalRHub\ f
)f g
{ 	
_context 
= 
context 
; 
_signalRHub 
= 

signalRHub $
;$ %
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
var 
account 
= 
HttpContext %
.% &
Session& -
.- .
	GetString. 7
(7 8
$str8 A
)A B
;B C
if 
( 
account 
!= 
$str "
)" #
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 7
)7 8
;8 9
var    
musicPlayerDbContext   $
=  % &
_context  ' /
.  / 0
	Playlists  0 9
.  9 :
Include  : A
(  A B
p  B C
=>  D F
p  G H
.  H I
User  I M
)  M N
;  N O
return!! 
View!! 
(!! 
await!!  
musicPlayerDbContext!! 2
.!!2 3
ToListAsync!!3 >
(!!> ?
)!!? @
)!!@ A
;!!A B
}"" 	
public%% 
async%% 
Task%% 
<%% 
IActionResult%% '
>%%' (
Details%%) 0
(%%0 1
int%%1 4
?%%4 5
id%%6 8
)%%8 9
{&& 	
if'' 
('' 
id'' 
=='' 
null'' 
||'' 
_context'' &
.''& '
	Playlists''' 0
==''1 3
null''4 8
)''8 9
{(( 
return)) 
NotFound)) 
())  
)))  !
;))! "
}** 
var,, 
playlist,, 
=,, 
await,,  
_context,,! )
.,,) *
	Playlists,,* 3
.-- 
Include-- 
(-- 
p-- 
=>-- 
p-- 
.--  
User--  $
)--$ %
... 
FirstOrDefaultAsync.. $
(..$ %
m..% &
=>..' )
m..* +
...+ ,

PlaylistId.., 6
==..7 9
id..: <
)..< =
;..= >
if// 
(// 
playlist// 
==// 
null//  
)//  !
{00 
return11 
NotFound11 
(11  
)11  !
;11! "
}22 
return44 
View44 
(44 
playlist44  
)44  !
;44! "
}55 	
public77 
async77 
Task77 
<77 
IActionResult77 '
>77' (
UserPlaylistDetails77) <
(77< =
int77= @
userid77A G
)77G H
{88 	
if99 
(99 
userid99 
==99 
null99 
||99 !
_context99" *
.99* +
	Playlists99+ 4
==995 7
null998 <
)99< =
{:: 
return;; 
NotFound;; 
(;;  
);;  !
;;;! "
}<< 
var>> 
playlist>> 
=>> 
await>>  
_context>>! )
.>>) *
	Playlists>>* 3
.?? 
Include?? 
(?? 
p?? 
=>?? 
p?? 
.??  
User??  $
)??$ %
.@@ 
Where@@ 
(@@ 
p@@ 
=>@@ 
p@@ 
.@@ 
User@@ !
.@@! "
UserId@@" (
==@@) +
userid@@, 2
)@@2 3
.AA 
FirstOrDefaultAsyncAA $
(AA$ %
)AA% &
;AA& '
ifBB 
(BB 
playlistBB 
==BB 
nullBB  
)BB  !
{CC 
returnDD 
NotFoundDD 
(DD  
)DD  !
;DD! "
}EE 
returnFF 
RedirectToActionFF #
(FF# $
$strFF$ -
,FF- .
$strFF/ :
,FF: ;
newFF< ?
{FF@ A
idFFA C
=FFD E
playlistFFF N
.FFN O

PlaylistIdFFO Y
}FFY Z
)FFZ [
;FF[ \
}GG 	
publicJJ 
IActionResultJJ 
CreateJJ #
(JJ# $
)JJ$ %
{KK 	
ViewDataLL 
[LL 
$strLL 
]LL 
=LL  
newLL! $

SelectListLL% /
(LL/ 0
_contextLL0 8
.LL8 9
UsersLL9 >
,LL> ?
$strLL@ H
,LLH I
$strLLJ R
)LLR S
;LLS T
returnMM 
ViewMM 
(MM 
)MM 
;MM 
}NN 	
[SS 	
HttpPostSS	 
]SS 
[TT 	$
ValidateAntiForgeryTokenTT	 !
]TT! "
publicUU 
asyncUU 
TaskUU 
<UU 
IActionResultUU '
>UU' (
CreateUU) /
(UU/ 0
[UU0 1
BindUU1 5
(UU5 6
$strUU6 O
)UUO P
]UUP Q
PlaylistUUR Z
playlistUU[ c
)UUc d
{VV 	
_contextWW 
.WW 
AddWW 
(WW 
playlistWW %
)WW% &
;WW& '
awaitXX 
_contextXX 
.XX 
SaveChangesAsyncXX /
(XX/ 0
)XX0 1
;XX1 2
returnYY 
RedirectToActionYY '
(YY' (
nameofYY( .
(YY. /
IndexYY/ 4
)YY4 5
)YY5 6
;YY6 7
}ZZ 	
public\\ 
async\\ 
Task\\ 
<\\ 
IActionResult\\ '
>\\' (
Edit\\) -
(\\- .
int\\. 1
?\\1 2
id\\3 5
)\\5 6
{]] 	
if^^ 
(^^ 
id^^ 
==^^ 
null^^ 
||^^ 
_context^^ &
.^^& '
	Playlists^^' 0
==^^1 3
null^^4 8
)^^8 9
{__ 
return`` 
NotFound`` 
(``  
)``  !
;``! "
}aa 
varcc 
playlistcc 
=cc 
awaitcc  
_contextcc! )
.cc) *
	Playlistscc* 3
.cc3 4
	FindAsynccc4 =
(cc= >
idcc> @
)cc@ A
;ccA B
ifdd 
(dd 
playlistdd 
==dd 
nulldd  
)dd  !
{ee 
returnff 
NotFoundff 
(ff  
)ff  !
;ff! "
}gg 
ViewDatahh 
[hh 
$strhh 
]hh 
=hh  
newhh! $

SelectListhh% /
(hh/ 0
_contexthh0 8
.hh8 9
Usershh9 >
,hh> ?
$strhh@ H
,hhH I
$strhhJ R
,hhR S
playlisthhT \
.hh\ ]
UserIdhh] c
)hhc d
;hhd e
returnii 
Viewii 
(ii 
playlistii  
)ii  !
;ii! "
}jj 	
[oo 	
HttpPostoo	 
]oo 
[pp 	$
ValidateAntiForgeryTokenpp	 !
]pp! "
publicqq 
asyncqq 
Taskqq 
<qq 
IActionResultqq '
>qq' (
Editqq) -
(qq- .
intqq. 1
?qq1 2
idqq3 5
,qq5 6
[qq7 8
Bindqq8 <
(qq< =
$strqq= V
)qqV W
]qqW X
PlaylistqqY a
playlistqqb j
)qqj k
{rr 	
ifxx 
(xx 

ModelStatexx 
.xx 
IsValidxx "
)xx" #
{yy 
tryzz 
{{{ 
_context|| 
.|| 
Update|| #
(||# $
playlist||$ ,
)||, -
;||- .
await}} 
_context}} "
.}}" #
SaveChangesAsync}}# 3
(}}3 4
)}}4 5
;}}5 6
}~~ 
catch 
( (
DbUpdateConcurrencyException 3
)3 4
{
ÄÄ 
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 
PlaylistExists
ÅÅ '
(
ÅÅ' (
playlist
ÅÅ( 0
.
ÅÅ0 1

PlaylistId
ÅÅ1 ;
)
ÅÅ; <
)
ÅÅ< =
{
ÇÇ 
return
ÉÉ 
NotFound
ÉÉ '
(
ÉÉ' (
)
ÉÉ( )
;
ÉÉ) *
}
ÑÑ 
else
ÖÖ 
{
ÜÜ 
throw
áá 
;
áá 
}
àà 
}
ââ 
return
ää 
RedirectToAction
ää '
(
ää' (
nameof
ää( .
(
ää. /
Index
ää/ 4
)
ää4 5
)
ää5 6
;
ää6 7
}
ãã 
ViewData
åå 
[
åå 
$str
åå 
]
åå 
=
åå  
new
åå! $

SelectList
åå% /
(
åå/ 0
_context
åå0 8
.
åå8 9
Users
åå9 >
,
åå> ?
$str
åå@ H
,
ååH I
$str
ååJ R
,
ååR S
playlist
ååT \
.
åå\ ]
UserId
åå] c
)
ååc d
;
ååd e
return
çç 
View
çç 
(
çç 
playlist
çç  
)
çç  !
;
çç! "
}
éé 	
public
ëë 
async
ëë 
Task
ëë 
<
ëë 
IActionResult
ëë '
>
ëë' (
Delete
ëë) /
(
ëë/ 0
int
ëë0 3
?
ëë3 4
id
ëë5 7
)
ëë7 8
{
íí 	
if
ìì 
(
ìì 
id
ìì 
==
ìì 
null
ìì 
||
ìì 
_context
ìì &
.
ìì& '
	Playlists
ìì' 0
==
ìì1 3
null
ìì4 8
)
ìì8 9
{
îî 
return
ïï 
NotFound
ïï 
(
ïï  
)
ïï  !
;
ïï! "
}
ññ 
var
òò 
playlist
òò 
=
òò 
await
òò  
_context
òò! )
.
òò) *
	Playlists
òò* 3
.
ôô 
Include
ôô 
(
ôô 
p
ôô 
=>
ôô 
p
ôô 
.
ôô  
User
ôô  $
)
ôô$ %
.
öö !
FirstOrDefaultAsync
öö $
(
öö$ %
m
öö% &
=>
öö' )
m
öö* +
.
öö+ ,

PlaylistId
öö, 6
==
öö7 9
id
öö: <
)
öö< =
;
öö= >
if
õõ 
(
õõ 
playlist
õõ 
==
õõ 
null
õõ  
)
õõ  !
{
úú 
return
ùù 
NotFound
ùù 
(
ùù  
)
ùù  !
;
ùù! "
}
ûû 
return
†† 
View
†† 
(
†† 
playlist
††  
)
††  !
;
††! "
}
°° 	
[
§§ 	
HttpPost
§§	 
,
§§ 

ActionName
§§ 
(
§§ 
$str
§§ &
)
§§& '
]
§§' (
[
•• 	&
ValidateAntiForgeryToken
••	 !
]
••! "
public
¶¶ 
async
¶¶ 
Task
¶¶ 
<
¶¶ 
IActionResult
¶¶ '
>
¶¶' (
DeleteConfirmed
¶¶) 8
(
¶¶8 9
int
¶¶9 <
id
¶¶= ?
)
¶¶? @
{
ßß 	
if
®® 
(
®® 
_context
®® 
.
®® 
	Playlists
®® "
==
®®# %
null
®®& *
)
®®* +
{
©© 
return
™™ 
Problem
™™ 
(
™™ 
$str
™™ V
)
™™V W
;
™™W X
}
´´ 
var
¨¨ 
playlist
¨¨ 
=
¨¨ 
await
¨¨  
_context
¨¨! )
.
¨¨) *
	Playlists
¨¨* 3
.
¨¨3 4
	FindAsync
¨¨4 =
(
¨¨= >
id
¨¨> @
)
¨¨@ A
;
¨¨A B
if
≠≠ 
(
≠≠ 
playlist
≠≠ 
!=
≠≠ 
null
≠≠  
)
≠≠  !
{
ÆÆ 
_context
ØØ 
.
ØØ 
	Playlists
ØØ "
.
ØØ" #
Remove
ØØ# )
(
ØØ) *
playlist
ØØ* 2
)
ØØ2 3
;
ØØ3 4
}
∞∞ 
await
≤≤ 
_context
≤≤ 
.
≤≤ 
SaveChangesAsync
≤≤ +
(
≤≤+ ,
)
≤≤, -
;
≤≤- .
return
≥≥ 
RedirectToAction
≥≥ #
(
≥≥# $
nameof
≥≥$ *
(
≥≥* +
Index
≥≥+ 0
)
≥≥0 1
)
≥≥1 2
;
≥≥2 3
}
¥¥ 	
private
∂∂ 
bool
∂∂ 
PlaylistExists
∂∂ #
(
∂∂# $
int
∂∂$ '
id
∂∂( *
)
∂∂* +
{
∑∑ 	
return
∏∏
 
(
∏∏ 
_context
∏∏ 
.
∏∏ 
	Playlists
∏∏ $
?
∏∏$ %
.
∏∏% &
Any
∏∏& )
(
∏∏) *
e
∏∏* +
=>
∏∏, .
e
∏∏/ 0
.
∏∏0 1

PlaylistId
∏∏1 ;
==
∏∏< >
id
∏∏? A
)
∏∏A B
)
∏∏B C
.
∏∏C D
GetValueOrDefault
∏∏D U
(
∏∏U V
)
∏∏V W
;
∏∏W X
}
ππ 	
}
∫∫ 
}ªª Ìq
bC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Controllers\SongsController.cs
	namespace		 	
Group5_MusicPlayer		
 
.		 
Controllers		 (
{

 
public 

class 
SongsController  
:! "

Controller# -
{ 
private 
readonly  
MusicPlayerDbContext -
_context. 6
;6 7
private 
readonly 
IHubContext $
<$ %
SignalrServer% 2
>2 3
_signalRHub4 ?
;? @
public 
SongsController 
(  
MusicPlayerDbContext 3
context4 ;
,; <
IHubContext= H
<H I
SignalrServerI V
>V W

signalRHubX b
)b c
{ 	
_context 
= 
context 
; 
_signalRHub 
= 

signalRHub $
;$ %
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
var 
account 
= 
HttpContext %
.% &
Session& -
.- .
	GetString. 7
(7 8
$str8 A
)A B
;B C
if 
( 
account 
!= 
$str "
)" #
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 7
)7 8
;8 9
var  
musicPlayerDbContext $
=% &
_context' /
./ 0
Songs0 5
.5 6
Include6 =
(= >
s> ?
=>@ B
sC D
.D E
AuthorE K
)K L
.L M
IncludeM T
(T U
sU V
=>W Y
sZ [
.[ \
Category\ d
)d e
;e f
return 
View 
( 
await  
musicPlayerDbContext 2
.2 3
ToListAsync3 >
(> ?
)? @
)@ A
;A B
} 	
public"" 
async"" 
Task"" 
<"" 
IActionResult"" '
>""' (
Details"") 0
(""0 1
int""1 4
?""4 5
id""6 8
)""8 9
{## 	
if$$ 
($$ 
id$$ 
==$$ 
null$$ 
||$$ 
_context$$ &
.$$& '
Songs$$' ,
==$$- /
null$$0 4
)$$4 5
{%% 
return&& 
NotFound&& 
(&&  
)&&  !
;&&! "
}'' 
var)) 
song)) 
=)) 
await)) 
_context)) %
.))% &
Songs))& +
.** 
Include** 
(** 
s** 
=>** 
s** 
.**  
Author**  &
)**& '
.++ 
Include++ 
(++ 
s++ 
=>++ 
s++ 
.++  
Category++  (
)++( )
.,, 
FirstOrDefaultAsync,, $
(,,$ %
m,,% &
=>,,' )
m,,* +
.,,+ ,
SongId,,, 2
==,,3 5
id,,6 8
),,8 9
;,,9 :
if-- 
(-- 
song-- 
==-- 
null-- 
)-- 
{.. 
return// 
NotFound// 
(//  
)//  !
;//! "
}00 
return22 
View22 
(22 
song22 
)22 
;22 
}33 	
public66 
IActionResult66 
Create66 #
(66# $
)66$ %
{77 	
ViewData88 
[88 
$str88 
]88  
=88! "
new88# &

SelectList88' 1
(881 2
_context882 :
.88: ;
Users88; @
,88@ A
$str88B J
,88J K
$str88L T
)88T U
;88U V
ViewData99 
[99 
$str99 !
]99! "
=99# $
new99% (

SelectList99) 3
(993 4
_context994 <
.99< =

Categories99= G
,99G H
$str99I U
,99U V
$str99W c
)99c d
;99d e
return:: 
View:: 
(:: 
):: 
;:: 
};; 	
[@@ 	
HttpPost@@	 
]@@ 
[AA 	$
ValidateAntiForgeryTokenAA	 !
]AA! "
publicBB 
asyncBB 
TaskBB 
<BB 
IActionResultBB '
>BB' (
CreateBB) /
(BB/ 0
[BB0 1
BindBB1 5
(BB5 6
$strBB6 t
)BBt u
]BBu v
SongBBw {
song	BB| Ä
)
BBÄ Å
{CC 	
_contextDD 
.DD 
AddDD 
(DD 
songDD !
)DD! "
;DD" #
awaitEE 
_contextEE 
.EE 
SaveChangesAsyncEE /
(EE/ 0
)EE0 1
;EE1 2
returnFF 
RedirectToActionFF '
(FF' (
nameofFF( .
(FF. /
IndexFF/ 4
)FF4 5
)FF5 6
;FF6 7
}GG 	
publicJJ 
asyncJJ 
TaskJJ 
<JJ 
IActionResultJJ '
>JJ' (
EditJJ) -
(JJ- .
intJJ. 1
?JJ1 2
idJJ3 5
)JJ5 6
{KK 	
ifLL 
(LL 
idLL 
==LL 
nullLL 
||LL 
_contextLL &
.LL& '
SongsLL' ,
==LL- /
nullLL0 4
)LL4 5
{MM 
returnNN 
NotFoundNN 
(NN  
)NN  !
;NN! "
}OO 
varQQ 
songQQ 
=QQ 
awaitQQ 
_contextQQ %
.QQ% &
SongsQQ& +
.QQ+ ,
	FindAsyncQQ, 5
(QQ5 6
idQQ6 8
)QQ8 9
;QQ9 :
ifRR 
(RR 
songRR 
==RR 
nullRR 
)RR 
{SS 
returnTT 
NotFoundTT 
(TT  
)TT  !
;TT! "
}UU 
ViewDataVV 
[VV 
$strVV 
]VV  
=VV! "
newVV# &

SelectListVV' 1
(VV1 2
_contextVV2 :
.VV: ;
UsersVV; @
,VV@ A
$strVVB J
,VVJ K
$strVVL T
,VVT U
songVVV Z
.VVZ [
AuthorIdVV[ c
)VVc d
;VVd e
ViewDataWW 
[WW 
$strWW !
]WW! "
=WW# $
newWW% (

SelectListWW) 3
(WW3 4
_contextWW4 <
.WW< =

CategoriesWW= G
,WWG H
$strWWI U
,WWU V
$strWWW c
,WWc d
songWWe i
.WWi j

CategoryIdWWj t
)WWt u
;WWu v
returnXX 
ViewXX 
(XX 
songXX 
)XX 
;XX 
}YY 	
[^^ 	
HttpPost^^	 
]^^ 
[__ 	$
ValidateAntiForgeryToken__	 !
]__! "
public`` 
async`` 
Task`` 
<`` 
IActionResult`` '
>``' (
Edit``) -
(``- .
int``. 1
?``1 2
id``3 5
,``5 6
[``7 8
Bind``8 <
(``< =
$str``= {
)``{ |
]``| }
Song	``~ Ç
song
``É á
)
``á à
{aa 	
ifcc 
(cc 

ModelStatecc 
.cc 
IsValidcc "
)cc" #
{dd 
tryee 
{ff 
_contextgg 
.gg 
Updategg #
(gg# $
songgg$ (
)gg( )
;gg) *
awaithh 
_contexthh "
.hh" #
SaveChangesAsynchh# 3
(hh3 4
)hh4 5
;hh5 6
}ii 
catchjj 
(jj (
DbUpdateConcurrencyExceptionjj 3
)jj3 4
{kk 
ifll 
(ll 
!ll 

SongExistsll #
(ll# $
songll$ (
.ll( )
SongIdll) /
)ll/ 0
)ll0 1
{mm 
returnnn 
NotFoundnn '
(nn' (
)nn( )
;nn) *
}oo 
elsepp 
{qq 
throwrr 
;rr 
}ss 
}tt 
returnuu 
RedirectToActionuu '
(uu' (
nameofuu( .
(uu. /
Indexuu/ 4
)uu4 5
)uu5 6
;uu6 7
}vv 
ViewDataww 
[ww 
$strww 
]ww  
=ww! "
newww# &

SelectListww' 1
(ww1 2
_contextww2 :
.ww: ;
Usersww; @
,ww@ A
$strwwB J
,wwJ K
$strwwL T
,wwT U
songwwV Z
.wwZ [
AuthorIdww[ c
)wwc d
;wwd e
ViewDataxx 
[xx 
$strxx !
]xx! "
=xx# $
newxx% (

SelectListxx) 3
(xx3 4
_contextxx4 <
.xx< =

Categoriesxx= G
,xxG H
$strxxI U
,xxU V
$strxxW c
,xxc d
songxxe i
.xxi j

CategoryIdxxj t
)xxt u
;xxu v
returnyy 
Viewyy 
(yy 
songyy 
)yy 
;yy 
}zz 	
public}} 
async}} 
Task}} 
<}} 
IActionResult}} '
>}}' (
Delete}}) /
(}}/ 0
int}}0 3
?}}3 4
id}}5 7
)}}7 8
{~~ 	
if 
( 
id 
== 
null 
|| 
_context &
.& '
Songs' ,
==- /
null0 4
)4 5
{
ÄÄ 
return
ÅÅ 
NotFound
ÅÅ 
(
ÅÅ  
)
ÅÅ  !
;
ÅÅ! "
}
ÇÇ 
var
ÑÑ 
song
ÑÑ 
=
ÑÑ 
await
ÑÑ 
_context
ÑÑ %
.
ÑÑ% &
Songs
ÑÑ& +
.
ÖÖ 
Include
ÖÖ 
(
ÖÖ 
s
ÖÖ 
=>
ÖÖ 
s
ÖÖ 
.
ÖÖ  
Author
ÖÖ  &
)
ÖÖ& '
.
ÜÜ 
Include
ÜÜ 
(
ÜÜ 
s
ÜÜ 
=>
ÜÜ 
s
ÜÜ 
.
ÜÜ  
Category
ÜÜ  (
)
ÜÜ( )
.
áá !
FirstOrDefaultAsync
áá $
(
áá$ %
m
áá% &
=>
áá' )
m
áá* +
.
áá+ ,
SongId
áá, 2
==
áá3 5
id
áá6 8
)
áá8 9
;
áá9 :
if
àà 
(
àà 
song
àà 
==
àà 
null
àà 
)
àà 
{
ââ 
return
ää 
NotFound
ää 
(
ää  
)
ää  !
;
ää! "
}
ãã 
return
çç 
View
çç 
(
çç 
song
çç 
)
çç 
;
çç 
}
éé 	
[
ëë 	
HttpPost
ëë	 
,
ëë 

ActionName
ëë 
(
ëë 
$str
ëë &
)
ëë& '
]
ëë' (
[
íí 	&
ValidateAntiForgeryToken
íí	 !
]
íí! "
public
ìì 
async
ìì 
Task
ìì 
<
ìì 
IActionResult
ìì '
>
ìì' (
DeleteConfirmed
ìì) 8
(
ìì8 9
int
ìì9 <
id
ìì= ?
)
ìì? @
{
îî 	
if
ïï 
(
ïï 
_context
ïï 
.
ïï 
Songs
ïï 
==
ïï !
null
ïï" &
)
ïï& '
{
ññ 
return
óó 
Problem
óó 
(
óó 
$str
óó R
)
óóR S
;
óóS T
}
òò 
Song
ôô 
song
ôô 
=
ôô 
await
ôô 
_context
ôô &
.
ôô& '
Songs
ôô' ,
.
ôô, -
Include
ôô- 4
(
ôô4 5
s
ôô5 6
=>
ôô7 9
s
ôô: ;
.
ôô; <
	SongLists
ôô< E
)
ôôE F
.
ôôF G!
FirstOrDefaultAsync
ôôG Z
(
ôôZ [
s
ôô[ \
=>
ôô] _
s
ôô` a
.
ôôa b
SongId
ôôb h
==
ôôi k
id
ôôl n
)
ôôn o
;
ôôo p
if
õõ 
(
õõ 
song
õõ 
!=
õõ 
null
õõ 
)
õõ 
{
úú 
if
ùù 
(
ùù 
song
ùù 
.
ùù 
	SongLists
ùù "
.
ùù" #
Count
ùù# (
>
ùù) *
$num
ùù+ ,
)
ùù, -
{
ûû 
foreach
üü 
(
üü 
SongList
üü %
songList
üü& .
in
üü/ 1
song
üü2 6
.
üü6 7
	SongLists
üü7 @
)
üü@ A
{
†† 
songList
°°  
.
°°  !
SongId
°°! '
=
°°( )
$num
°°* +
;
°°+ ,
}
¢¢ 
}
££ 
_context
§§ 
.
§§ 
Songs
§§ 
.
§§ 
Remove
§§ %
(
§§% &
song
§§& *
)
§§* +
;
§§+ ,
}
•• 
await
ßß 
_context
ßß 
.
ßß 
SaveChangesAsync
ßß +
(
ßß+ ,
)
ßß, -
;
ßß- .
return
®® 
RedirectToAction
®® #
(
®®# $
nameof
®®$ *
(
®®* +
Index
®®+ 0
)
®®0 1
)
®®1 2
;
®®2 3
}
©© 	
private
´´ 
bool
´´ 

SongExists
´´ 
(
´´  
int
´´  #
id
´´$ &
)
´´& '
{
¨¨ 	
return
≠≠
 
(
≠≠ 
_context
≠≠ 
.
≠≠ 
Songs
≠≠  
?
≠≠  !
.
≠≠! "
Any
≠≠" %
(
≠≠% &
e
≠≠& '
=>
≠≠( *
e
≠≠+ ,
.
≠≠, -
SongId
≠≠- 3
==
≠≠4 6
id
≠≠7 9
)
≠≠9 :
)
≠≠: ;
.
≠≠; <
GetValueOrDefault
≠≠< M
(
≠≠M N
)
≠≠N O
;
≠≠O P
}
ÆÆ 	
}
ØØ 
}∞∞ ˇ
aC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Controllers\HomeController.cs
	namespace 	
Group5_MusicPlayer
 
. 
Controllers (
{		 
public

 

class

 
HomeController

 
:

  !

Controller

" ,
{ 
private 
readonly  
MusicPlayerDbContext -
_context. 6
;6 7
public 
HomeController 
(  
MusicPlayerDbContext 2
context3 :
): ;
{ 	
_context 
= 
context 
; 
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
var  
musicPlayerDbContext $
=% &
_context' /
./ 0
Songs0 5
.5 6
Include6 =
(= >
s> ?
=>@ B
sC D
.D E
AuthorE K
)K L
.L M
IncludeM T
(T U
sU V
=>W Y
sZ [
.[ \
Category\ d
)d e
.e f
Wheref k
(k l
sl m
=>n p
sq r
.r s
	IsPrivates |
==} 
false
Ä Ö
)
Ö Ü
;
Ü á
return 
View 
(  
musicPlayerDbContext ,
., -
ToList- 3
(3 4
)4 5
)5 6
;6 7
} 	
public 
IActionResult 
Privacy $
($ %
)% &
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
ResponseCache	 
( 
Duration 
=  !
$num" #
,# $
Location% -
=. /!
ResponseCacheLocation0 E
.E F
NoneF J
,J K
NoStoreL S
=T U
trueV Z
)Z [
][ \
public   
IActionResult   
Error   "
(  " #
)  # $
{!! 	
return"" 
View"" 
("" 
new"" 
ErrorViewModel"" *
{""+ ,
	RequestId""- 6
=""7 8
Activity""9 A
.""A B
Current""B I
?""I J
.""J K
Id""K M
??""N P
HttpContext""Q \
.""\ ]
TraceIdentifier""] l
}""m n
)""n o
;""o p
}## 	
}$$ 
}%% ÓU
gC:\Users\admin\Desktop\PRN221Final\5_MusicPlayer\Group5_MusicPlayer\Controllers\CategoriesController.cs
	namespace 	
Group5_MusicPlayer
 
. 
Controllers (
{ 
public 

class  
CategoriesController %
:& '

Controller( 2
{ 
private 
readonly  
MusicPlayerDbContext -
_context. 6
;6 7
private 
readonly 
IHubContext $
<$ %
SignalrServer% 2
>2 3
_signalRHub4 ?
;? @
public  
CategoriesController #
(# $ 
MusicPlayerDbContext$ 8
context9 @
,@ A
IHubContextB M
<M N
SignalrServerN [
>[ \

signalRHub] g
)g h
{ 	
_context 
= 
context 
; 
_signalRHub 
= 

signalRHub $
;$ %
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
var 
account 
= 
HttpContext %
.% &
Session& -
.- .
	GetString. 7
(7 8
$str8 A
)A B
;B C
if 
( 
account 
!= 
$str "
)" #
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 7
)7 8
;8 9
return   
_context   
.   

Categories   &
!=  ' )
null  * .
?  / 0
View!! 
(!! 
await!! $
_context!!% -
.!!- .

Categories!!. 8
.!!8 9
ToListAsync!!9 D
(!!D E
)!!E F
)!!F G
:!!H I
Problem"" !
(""! "
$str""" Z
)""Z [
;""[ \
}## 	
public&& 
async&& 
Task&& 
<&& 
IActionResult&& '
>&&' (
Details&&) 0
(&&0 1
int&&1 4
?&&4 5
id&&6 8
)&&8 9
{'' 	
if(( 
((( 
id(( 
==(( 
null(( 
||(( 
_context(( &
.((& '

Categories((' 1
==((2 4
null((5 9
)((9 :
{)) 
return** 
NotFound** 
(**  
)**  !
;**! "
}++ 
var-- 
category-- 
=-- 
await--  
_context--! )
.--) *

Categories--* 4
... 
FirstOrDefaultAsync.. $
(..$ %
m..% &
=>..' )
m..* +
...+ ,

CategoryId.., 6
==..7 9
id..: <
)..< =
;..= >
if// 
(// 
category// 
==// 
null//  
)//  !
{00 
return11 
NotFound11 
(11  
)11  !
;11! "
}22 
return44 
View44 
(44 
category44  
)44  !
;44! "
}55 	
public88 
IActionResult88 
Create88 #
(88# $
)88$ %
{99 	
return:: 
View:: 
(:: 
):: 
;:: 
};; 	
[@@ 	
HttpPost@@	 
]@@ 
[AA 	$
ValidateAntiForgeryTokenAA	 !
]AA! "
publicBB 
asyncBB 
TaskBB 
<BB 
IActionResultBB '
>BB' (
CreateBB) /
(BB/ 0
[BB0 1
BindBB1 5
(BB5 6
$strBB6 [
)BB[ \
]BB\ ]
CategoryBB^ f
categoryBBg o
)BBo p
{CC 	
_contextDD 
.DD 
AddDD 
(DD 
categoryDD %
)DD% &
;DD& '
awaitEE 
_contextEE 
.EE 
SaveChangesAsyncEE /
(EE/ 0
)EE0 1
;EE1 2
returnFF 
RedirectToActionFF '
(FF' (
nameofFF( .
(FF. /
IndexFF/ 4
)FF4 5
)FF5 6
;FF6 7
}GG 	
publicJJ 
asyncJJ 
TaskJJ 
<JJ 
IActionResultJJ '
>JJ' (
EditJJ) -
(JJ- .
intJJ. 1
?JJ1 2
idJJ3 5
)JJ5 6
{KK 	
ifLL 
(LL 
idLL 
==LL 
nullLL 
||LL 
_contextLL &
.LL& '

CategoriesLL' 1
==LL2 4
nullLL5 9
)LL9 :
{MM 
returnNN 
NotFoundNN 
(NN  
)NN  !
;NN! "
}OO 
varQQ 
categoryQQ 
=QQ 
awaitQQ  
_contextQQ! )
.QQ) *

CategoriesQQ* 4
.QQ4 5
	FindAsyncQQ5 >
(QQ> ?
idQQ? A
)QQA B
;QQB C
ifRR 
(RR 
categoryRR 
==RR 
nullRR  
)RR  !
{SS 
returnTT 
NotFoundTT 
(TT  
)TT  !
;TT! "
}UU 
returnVV 
ViewVV 
(VV 
categoryVV  
)VV  !
;VV! "
}WW 	
[\\ 	
HttpPost\\	 
]\\ 
[]] 	$
ValidateAntiForgeryToken]]	 !
]]]! "
public^^ 
async^^ 
Task^^ 
<^^ 
IActionResult^^ '
>^^' (
Edit^^) -
(^^- .
int^^. 1
?^^1 2
id^^3 5
,^^5 6
[^^7 8
Bind^^8 <
(^^< =
$str^^= b
)^^b c
]^^c d
Category^^e m
category^^n v
)^^v w
{__ 	
ifee 
(ee 

ModelStateee 
.ee 
IsValidee "
)ee" #
{ff 
trygg 
{hh 
_contextii 
.ii 
Updateii #
(ii# $
categoryii$ ,
)ii, -
;ii- .
awaitjj 
_contextjj "
.jj" #
SaveChangesAsyncjj# 3
(jj3 4
)jj4 5
;jj5 6
}kk 
catchll 
(ll (
DbUpdateConcurrencyExceptionll 3
)ll3 4
{mm 
ifnn 
(nn 
!nn 
CategoryExistsnn '
(nn' (
categorynn( 0
.nn0 1

CategoryIdnn1 ;
)nn; <
)nn< =
{oo 
returnpp 
NotFoundpp '
(pp' (
)pp( )
;pp) *
}qq 
elserr 
{ss 
throwtt 
;tt 
}uu 
}vv 
returnww 
RedirectToActionww '
(ww' (
nameofww( .
(ww. /
Indexww/ 4
)ww4 5
)ww5 6
;ww6 7
}xx 
returnyy 
Viewyy 
(yy 
categoryyy  
)yy  !
;yy! "
}zz 	
public}} 
async}} 
Task}} 
<}} 
IActionResult}} '
>}}' (
Delete}}) /
(}}/ 0
int}}0 3
?}}3 4
id}}5 7
)}}7 8
{~~ 	
if 
( 
id 
== 
null 
|| 
_context &
.& '

Categories' 1
==2 4
null5 9
)9 :
{
ÄÄ 
return
ÅÅ 
NotFound
ÅÅ 
(
ÅÅ  
)
ÅÅ  !
;
ÅÅ! "
}
ÇÇ 
var
ÑÑ 
category
ÑÑ 
=
ÑÑ 
await
ÑÑ  
_context
ÑÑ! )
.
ÑÑ) *

Categories
ÑÑ* 4
.
ÖÖ !
FirstOrDefaultAsync
ÖÖ $
(
ÖÖ$ %
m
ÖÖ% &
=>
ÖÖ' )
m
ÖÖ* +
.
ÖÖ+ ,

CategoryId
ÖÖ, 6
==
ÖÖ7 9
id
ÖÖ: <
)
ÖÖ< =
;
ÖÖ= >
if
ÜÜ 
(
ÜÜ 
category
ÜÜ 
==
ÜÜ 
null
ÜÜ  
)
ÜÜ  !
{
áá 
return
àà 
NotFound
àà 
(
àà  
)
àà  !
;
àà! "
}
ââ 
return
ãã 
View
ãã 
(
ãã 
category
ãã  
)
ãã  !
;
ãã! "
}
åå 	
[
èè 	
HttpPost
èè	 
,
èè 

ActionName
èè 
(
èè 
$str
èè &
)
èè& '
]
èè' (
[
êê 	&
ValidateAntiForgeryToken
êê	 !
]
êê! "
public
ëë 
async
ëë 
Task
ëë 
<
ëë 
IActionResult
ëë '
>
ëë' (
DeleteConfirmed
ëë) 8
(
ëë8 9
int
ëë9 <
id
ëë= ?
)
ëë? @
{
íí 	
if
ìì 
(
ìì 
_context
ìì 
.
ìì 

Categories
ìì #
==
ìì$ &
null
ìì' +
)
ìì+ ,
{
îî 
return
ïï 
Problem
ïï 
(
ïï 
$str
ïï W
)
ïïW X
;
ïïX Y
}
ññ 
var
óó 
category
óó 
=
óó 
await
óó  
_context
óó! )
.
óó) *

Categories
óó* 4
.
óó4 5
	FindAsync
óó5 >
(
óó> ?
id
óó? A
)
óóA B
;
óóB C
if
òò 
(
òò 
category
òò 
!=
òò 
null
òò  
)
òò  !
{
ôô 
_context
öö 
.
öö 

Categories
öö #
.
öö# $
Remove
öö$ *
(
öö* +
category
öö+ 3
)
öö3 4
;
öö4 5
}
õõ 
await
ùù 
_context
ùù 
.
ùù 
SaveChangesAsync
ùù +
(
ùù+ ,
)
ùù, -
;
ùù- .
return
ûû 
RedirectToAction
ûû #
(
ûû# $
nameof
ûû$ *
(
ûû* +
Index
ûû+ 0
)
ûû0 1
)
ûû1 2
;
ûû2 3
}
üü 	
private
°° 
bool
°° 
CategoryExists
°° #
(
°°# $
int
°°$ '
id
°°( *
)
°°* +
{
¢¢ 	
return
££
 
(
££ 
_context
££ 
.
££ 

Categories
££ %
?
££% &
.
££& '
Any
££' *
(
££* +
e
££+ ,
=>
££- /
e
££0 1
.
££1 2

CategoryId
££2 <
==
££= ?
id
££@ B
)
££B C
)
££C D
.
££D E
GetValueOrDefault
££E V
(
££V W
)
££W X
;
££X Y
}
§§ 	
}
•• 
}¶¶ 